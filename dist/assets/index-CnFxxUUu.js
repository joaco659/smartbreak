(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function s(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(e){if(e.ep)return;e.ep=!0;const n=s(e);fetch(e.href,n)}})();class g{constructor(o,s){const t=this;let e,n,c;this.interval=s,this.start=function(){c=!1,e=Date.now()+this.interval,n=setTimeout(f,this.interval)},this.stop=function(){c=!0,clearTimeout(n)};function f(){const p=Date.now()-e;p>t.interval,o(),!c&&(e+=t.interval,n=setTimeout(f,Math.max(0,t.interval-p)))}}}const E=document.querySelectorAll("input[name=rest-opt]"),h=document.getElementById("custom-time"),d=document.querySelector(".timer-init-button"),y=document.querySelector(".custom-time-container"),u=document.getElementById("error-message"),l=document.getElementById("timer");let r,a;function T(i){const o=Math.floor(i/60),s=i%60;return`${o.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`}const I=new Event("FinishedTime");l.addEventListener("FinishedTime",()=>{l.textContent="00:00"});E.forEach(i=>{i.addEventListener("change",()=>{i.dataset.timeInSeconds=="custom"?y.style.display="block":y.style.display="none"})});r=0;const m=new g(()=>{l.textContent=T(r--),sessionStorage.setItem("TIMER",r),r==0&&(d.textContent="INICIAR",a=!1,console.log("FINISHED TIMER"),l.dispatchEvent(I),new Notification("Tu descanso ha terminado."),m.stop())},1e3);document.addEventListener("DOMContentLoaded",()=>{sessionStorage.getItem("TIMER")&&sessionStorage.getItem("TIMER")!=0&&(a=!0,d.textContent="DETENER",r=sessionStorage.getItem("TIMER"),m.start())});a=!1;document.getElementById("rest-form").addEventListener("submit",i=>{if(i.preventDefault(),a){console.log("STOPPED TIMER"),m.stop(),l.dispatchEvent(I),d.textContent="INICIAR",a=!1,r=0,sessionStorage.setItem("TIMER",r);return}u.textContent="";let o;if(E.forEach(t=>{t.checked&&(o=t.dataset.timeInSeconds)}),!o){u.textContent="Selecciona una opcion.",console.log("no option selected");return}if(o=="custom"){const t=parseInt(h.value);if(isNaN(t)||t<1||t>3600){u.textContent="Ingresa un tiempo mayor a cero y menor a una hora.",console.log("custom time is invalid");return}o=t}document.querySelector(".modal").style.display="block";const s=()=>{a=!0,d.textContent="DETENER",r=parseInt(o),m.start(),console.log("STARTED TIMER")};"Notification"in window?Notification.permission=="granted"?(document.querySelector(".modal").style.display="none",s()):Notification.requestPermission().then(t=>{t=="denied"?setTimeout(()=>document.querySelector(".modal").style.display="none",5e3):t=="granted"&&(document.querySelector(".modal").style.display="none")}).finally(s):console.warn("El navegador no puede mandar notificaciones")});
